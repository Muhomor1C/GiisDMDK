# GiisDMDK
<div class="tab">
  <button class="tablinks" onclick="openRu(event, 'RU')">London</button>
  <button class="tablinks" onclick="openCity(event, 'Paris')">Paris</button>
  <button class="tablinks" onclick="openCity(event, 'Tokyo')">Tokyo</button>
</div>

<!-- Tab content -->
<div id="RU" class="tabcontent">
  <h3>Русский</h3>
  <p>Консольная утилита печати контрольных марок для ювелирных изделий на принтере этикеток.

Задача:
  Необходимо напечатать этикетки для ювелирных изделий, которые поступили в розничный оборот до 31.12.21(до
введения обязательной маркировки на предприятиях изготовителях. Т.Н. - остатки)
Имеется XLS файл с полученными из государственной инрформационной системы контроля за драг. металлами и драг. камнями (ГИИС ДМДК)
уникальными идентификационными кодами(УИН). Необходимо сопоставить эти номера со штрихкодами изделий в формате EAN13
и написать утилиту для изготовления этикеток с этим УИН в виде DataMatrix кода.

Решение:
  У клиента имеется в наличии принтер этикеток TSC TDP-225, который и был взят за основу.
Подключена библиотека SDK TSCLIB.dll, с помощью которой налажено прямое управление принтером
минуя диспетчер печати Windows.

Файлы с данными о товаре из "1С:Ювелирный магазин", были переведены в CSV для быстроты и удобства работы и сопоставлены с данными из ГИИС.
В итоге получил файл END.CSV, в котором имеется все необходимое. Эта работа не отражена в репозитории. Желающим могу вылсать утилиту,
написанную для этого.

  В конечном итоге, работник сканирует заводской ярлык изделия и принтер автоматически печатает этикетку с УИН кодом
в виде DataMatrix. Кроме того, на этикетке печатается наименование изделия, общий вес и отдельно вес драг. металлов, оригинальный
штрихкод и линия сгиба, по которой этикетка наклеивается на контрольную нить изделия.
При должной сноровке, печать и поклейка этикетки занимает не более 10 секунд, что немаловажно, учитывая количество
товара(тысячи позиций в нескольких магазинах сети клиента).

Порядок полей в CSV файле:

0 - внутренний ID товара(не обязателен для заполнения)

1 - УИН

2 - Наименование

3 - Общий вес

4 - Вес металла

5 - Штрихкод


Этикетка 30*20 мм. Склеивается пополам, получается маленький, аккуратный ярлычек.


  Что не сделано(TODO):
  Утилита должна работать на всех принтерах TSC, но проверить нет возможности из за отсутствия техники. Как и нет возможности 
  поэксперементировать с другими производителями.
  Формат и размер этикетки жестко настроен в программе. Возможно когда то я доработаю этот момент.
  Было бы не плохо привинтить UI, но категорически нехватает времени
  
![IMG_20220609_235425883](https://user-images.githubusercontent.com/86445162/172951919-2e6c9c4d-25aa-4bb7-930a-83f0175b0822.jpg)

![IMG_20220610_003542349](https://user-images.githubusercontent.com/86445162/172956591-f4222b20-af57-4a02-9c47-0d002e2a46b6.jpg)

![IMG_20220610_004024628](https://user-images.githubusercontent.com/86445162/172957075-bf290e92-0300-41ac-8a32-d0f51f92d727.jpg)
</p>
</div>

<div id="Paris" class="tabcontent">
  <h3>Paris</h3>
  <p>Paris is the capital of France.</p>
</div>

<div id="Tokyo" class="tabcontent">
  <h3>Tokyo</h3>
  <p>Tokyo is the capital of Japan.</p>
</div>
